---
layout:     post
title:      "CTCloss"
subtitle:   " \"损失函数\""
date:       2020-09-21 18:00:00
mathjax: true
author:     "zwt"
header-img: "img/post-bg-2015.jpg"
catalog: false
tags:
    - 语音识别
---
* TOC
{:toc}
# 目的

针对语音识别中字符与因素的对应，手写识别中字符与图片的对应、视频标记中动作的标记等诸如输入与输出对应的问题。
![](https://zwt0204.github.io//img/ctcloss.png)
上述场景下（各个输入之间没有明确的界限），正是CTC（Connectionist Temporal Classiﬁcation）用武之地。CTC是一种让网络自动学会对齐的好方法，十分适合语音识别和书写识别。

# 基本原理

![](https://zwt0204.github.io//img/ctcloss1.png)
如上图所示：ctcloss在字符与字符之间加入特殊的字符$\epsilon$,如果是连续相同的字符之间也要加入特殊符号来做区分。

# 主要解决的问题

例如对于一个输入序列：
$$
X = [x_1, x_2, x_3,....x_T]
$$
在语音识别中其表示的就是T个帧，每一个帧$x_t$是一个MFCC提取的n维特征，输出序列为：
$$
Y = [y_1, y_2, y_3,....y_U]
$$
对于上述的任务来说，很难说将其转化为一般的分类任务，因为：
```
X和Y都是变长的
X和Y的长度也是变化的，也就是说X和Y的长度之间不存在简单的比例对应关系
训练数据中X和Y很难有对齐的情况
```
也许有人说可以将其认为是序列标注问题，但是注意，一般的序列标注问题是存在清晰的边界的，输入输出都是逻辑符号，符号之间边界明显，可以很好的建模，同时在前期也被当作分类任务来处理。但是对于语音识别问题，输入的是 语音信号，输入之间没有明显的界限，输入和输出没有办法进行对齐。

CTC的提出就是为了解决这一类问题，对于一个给定的X，CTC可以对所有可能的Y计算P(Y|X)。炸这样就可以计算出相应的某个Y的概率。

CTC给出的是一个较优的路径，是在合理的时间内选择一个可以接受的解。

==这个不也可以强行的对齐，然后当作序列标注任务来处理吗，比如强行的加入特殊符号，这样输入和输出就可以对应起来？为什么不行？==

# 详解

对于给定的X，CTC可以计算出所有输出Y的概率，这个计算的关键在于CTC对于输入输出的对齐处理。

## 对齐

![](https://zwt0204.github.io//img/ctcloss2.png)
主要解决了两个问题，比如语音识别中的静音，不应该有输出，第二个问题，输出有相同的字符。
![](https://zwt0204.github.io//img/ctcloss3.png)



# 特点

ctc假设输出是相互独立的，所以没有办法学习到输出的上下文关系，也就是缺失了语言模型
ctc的对齐方式是单调的，适用于语音识别但是对于其他诸如翻译等场景是不适合的
ctc的输入与输出是多对一的关系.输入序列的长度一定大于等于输出长度。

# 参考
1. [李理的博客ctc](http://fancyerii.github.io/books/ctc/)















