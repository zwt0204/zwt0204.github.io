---
layout:     post
title:      "pandas"
subtitle:   " \"pandas\""
date:       2021-02-05 18:00:00
author:     "zwt"
header-img: "img/post-bg-2015.jpg"
catalog: false
tags:
    - 工具
---
* TOC
{:toc}

# 一些操作
```
pandas获取行列数：列数df.shape[1] 行数df.sgape[0]
根据值定位元素：
值不大的情况： df.loc['20191228','B'] = 2222
值比较大的情况：
temp = (self.data['pid'] == np.int64(pid))
        a = np.flatnonzero(temp)
        temp = self.data.iloc[a[0]].tolist()
pd转np： df.values、df.as_matrix()、np.array(df)
保存为csv：dt.to_csv('Result.csv',sep='?',na_rep='NA',float_format='%.2f',index=0)
将ndarray转为series
pred = pd.Series(y_pred.tolist())

DataFrame.info  显示DataFrame的简要摘要，显示有关DataFrame的有关信息，包括索引列的数据类型dtype和列的数据类型，非空值的数量和内存使用状况情况

DataFrame.fillna  填充缺失值

data.value_counts() 计算某列有那些不同的值，并计算每个值有多少重复值
```

# 错误纠正
```
错误提示：pandas.errors.ParserError: Error tokenizing data. C error: EOF inside string starting at line 15945
df = pd.read_csv(csvfile, quoting=csv.QUOTE_NONE, encoding='utf-8')
```

# 按照pid合并后面的数据：
```
def ab(df):
    data = [eval(i) for i in df.values.tolist()]
    res = []
    for i in data:
        res.extend(i)
    data = list(set(res))
    return " ".join('%s' %(id) for id in data)

df = pd.read_csv('eng.txt', sep='\t')
df = df.groupby(['pid'])['eng'].apply(ab)
df = df.reset_index()
```
# 字典读取为Dataframe

```
test_dict = {'id':[1,2,3,4,5,6],'name':['Alice','Bob','Cindy','Eric','Helen','Grace '],'math':[90,89,99,78,97,93],'english':[89,94,80,94,94,90]}
test_dict_df = pd.DataFrame(test_dict)
```

# 字符串操作
```
#对字符串进⾏⼤写转换
s = strs.str.upper()
# 对字符串进⾏⼩写转换
ss = strs.str.lower()

match()	对每个元素调用 re.match()，返回布尔类型值
extract()	对每个元素调用 re.match()，返回匹配的字符串组（groups）
findall()	对每个元素调用 re.findall()
replace()	用正则模式替换字符串
contains()	对每个元素调用 re.search()，返回布尔类型值
count()	计算符合正则模式的字符串的数量
split()	等价于 str.split()，支持正则表达式
rsplit()	等价于 str.rsplit()，支持正则表达式
```
# map

```
data['index'].map(lambda x: fun(x))
map也可以替换为apply
```