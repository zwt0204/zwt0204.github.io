---
layout:     post
title:      "深度学习部署"
subtitle:   " \"onnx\""
date:       2021-11-17 18:00:00
mathjax: true
author:     "zwt"
header-img: "img/post-bg-2015.jpg"
catalog: false
tags:
    - 深度学习
---
* TOC
{:toc}

# 代码示例
```
<!-- https://mvnrepository.com/artifact/org.bytedeco/onnxruntime-platform -->
        <dependency>
            <groupId>org.bytedeco</groupId>
            <artifactId>onnxruntime-platform</artifactId>
            <version>1.8.1-1.5.6</version>
        </dependency>

import ai.onnxruntime.OnnxTensor;
import ai.onnxruntime.OrtEnvironment;
import ai.onnxruntime.OrtException;
import ai.onnxruntime.OrtSession;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;

public class MainCLI {
    public static void main(String[] args) {
        String modelFile = "src/main/resources/model.onnx";
        System.out.println("Loading model from " + modelFile);
        OrtEnvironment env = OrtEnvironment.getEnvironment();
        try {
            OrtSession session = env.createSession(modelFile, new OrtSession.SessionOptions());
            // 输入
            float[][] inputArr = new float[1][103];
            OnnxTensor t1 = OnnxTensor.createTensor(env, inputArr);
            Map<String, OnnxTensor> inputs = new HashMap<>();
            inputs.put("input.1", t1);
            // 执行
            OrtSession.Result results = session.run(inputs);
            System.out.println("output (" + results.size() + "): " + results.get(0).getInfo());
            float[][] labels = (float[][]) results.get(0).getValue();
            System.out.println("output value: " + Arrays.toString(labels[0]));
        } catch (OrtException e) {
            e.printStackTrace();
            try {
                env.close();
            } catch (OrtException oe) {
                oe.printStackTrace();
            }}}}
```